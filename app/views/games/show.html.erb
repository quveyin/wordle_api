<% content_for :title, "Wordle" %>

<div class="container">
    <h1>Wordle</h1>
    

    
    <% unless @game.completed? %>
        <div class="game-info">
            Deneme: <%= @game.guesses.count %>/6
        </div>
    <% end %>
    
    <div class="attempts">
        <% if @guesses.any? %>
            <% @guesses.each do |guess| %>
                <div class="attempt">
                    <% result = guess.feedback %>
                    <% guess.word.chars.each_with_index do |char, index| %>
                        <div class="letter <%= case result[index]
                                               when 'correct' then 'correct'
                                               when 'present' then 'present'
                                               else 'absent'
                                               end %>">
                            <%= char.upcase %>
                        </div>
                    <% end %>
                </div>
            <% end %>
        <% end %>
    </div>
    
    <% unless @game.completed? %>
        <div class="input-form">
            <%= form_with url: guess_game_path(@game), method: :post, local: true do |f| %>
                <%= f.text_field :word, 
                    maxlength: 5, 
                    placeholder: "5 harfli kelime",
                    required: true,
                    autofocus: true,
                    autocomplete: "off" %>
                <%= f.submit "Tahmin Et" %>
            <% end %>
        </div>
    <% end %>
    
    <% if @game.completed? %>
        <% if @game.won? %>
            <div class="notice">
                TEBRİKLER. Kelimeyi <%= @game.guesses.count %>. denemede buldunuz: <strong><%= @game.secret_word.upcase %></strong>
            </div>
        <% else %>
            <div class="alert">
                Deneme hakkınız tükendi.Doğru kelime: <strong><%= @game.secret_word.upcase %></strong>
            </div>
        <% end %>
        
        <%= form_with url: games_path, method: :post, local: true do |f| %>
            <%= f.submit "Yeni Oyun" %>
        <% end %>
    <% end %>
</div>
